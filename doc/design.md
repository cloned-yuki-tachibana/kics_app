# KICKS APP design document

```plantuml
@startuml
left to right direction

:在宅勤務人: as A

A -> (1)
(1) -> (2)
(1) -> (3)
(1) -> (4)
(4) -down-> (5)
(1) -> (6)

(在宅勤務での勤務管理が簡単になるようにしてほしい) as (1)
(中抜けの時間を簡単に計算したい) as (2)
(VPNの接続・切断を自動で行ってほしい) as (3)
(KICKSへの勤務時間入力も自動で行ってほしい) as (4)
(Teamsへの投稿も自動でできるといい) as (5)
(GUIによる簡単操作) as (6)
(ツール利用の上で間違いがあると使用できない) as (7)

@enduml
```

```plantuml
@startuml
actor USER as A
control APP as B
participant "External(KICKS)" as C

A -> B : 初回ユーザ登録(DSC ID)
A -> B : 勤務開始ボタン押下
activate B
note over B
時間取得
VPN 接続
endnote
A -> B : 中抜けボタン押下
deactivate B
note over B
時間取得
VPN 切断
endnote
A -> B : 再開ボタン押下
activate B
note over B
時間取得
VPN 接続
endnote
A -> B : 勤務終了ボタン押下
note over B
時間取得
業務時間計算
endnote
A <- B : 勤務情報計算結果確認
A -> B : 応答
B -> C : 勤務情報登録
note over B
VPN切断
endnote
deactivate B

@enduml
```

```plantuml
@startuml

State "勤務準備状態" as A
State "勤務中状態" as B
State "休憩状態" as C

[*] --> A
A -right-> B : 勤務開始ボタン押下
B -->      C : 休憩ボタン押下
C -->      B : 勤務再開ボタン押下
B -left->  A : 勤務終了ボタン押下
@enduml
```

※勤務中状態からは休憩ボタンは押せないようにする
※休憩状態から勤務終了ボタンは・・・・現状では押せないとする
勤務再開→勤務終了の手順を踏んでもらう

## 状態遷移表

| アクション名       | アクションアイテム                                      | アクション後状態 |
| ------------------ | ------------------------------------------------------- | ---------------- |
| 勤務開始ボタン押下 | 確認 時間取得 VPN接続 ボタン切り替え                    | 勤務中状態       |
| 勤務終了ボタン押下 | 確認 時間取得 勤務終了シーケンス VPN切断 ボタン切り替え | 勤務準備状態     |
| 休憩ボタン押下     | 確認 時間取得 VPN切断 ボタン切り替え                    | 休憩状態         |
| 勤務再開ボタン押下 | 確認 時間取得 VPN接続 ボタン切り替え                    | 勤務中状態       |

勤務開始ボタン押下 ＝ 勤務再開ボタン押下

### 今の状態が横軸。各イベントで次の状態がどうなるかの表

| 次の状態       | 勤務前     | 勤務中     | 休憩中     |
| -------------- | ---------- | ---------- | ---------- |
| 勤務ボタン押下 | 勤務中状態 | 勤務前状態 | 勤務中状態 |
| 休憩ボタン押下 | 押せない   | 休憩状態   | 押せない   |

### 今の状態が横軸。各イベントで行うべきアクションが何かの表

| アクション     | 勤務前   | 勤務中   | 休憩中   |
| -------------- | -------- | -------- | -------- |
| 勤務ボタン押下 | 勤務開始 | 勤務終了 | 勤務再開 |
| 休憩ボタン押下 | -        | 休憩     | -        |

### 今の状態が横軸。各イベントでVPNに対して行うべきアクションが何かの表

| アクション     | 勤務前 | 勤務中 | 休憩中 |
| -------------- | ------ | ------ | ------ |
| 勤務ボタン押下 | 接続   | 切断   | 接続   |
| 休憩ボタン押下 | -      | 切断   | -      |

### アクションアイテム詳細

| アクションアイテム名 | 詳細                                   |
| -------------------- | -------------------------------------- |
| 時間取得             | アクション発生日時を計算しリストに格納 |
| VPN接続              | -                                      |
| VPN切断              | -                                      |
| 勤務終了シーケンス   | 別記                                   |

勤務終了シーケンス詳細

1. 時間リストを解釈し、勤務開始時間・勤務終了時間・業務時間を算出
2. ユーザに内容確認を表示
3. KICKSにPOSTし勤務情報を登録（別ファイル？に保存されたパスワード情報を利用）
4. ユーザに完了ポップアップを表示
5. リストを初期化

状態とボタンの有効について
|            | 勤務前 | 勤務中 | 休憩中 |
| ---------- | ------ | ------ | ------ |
| 勤務ボタン | 〇     | 〇     | 〇     |
| 休憩ボタン | ☓      | 〇     | ☓      |

```mermaid
graph TD
  USER[USER]
  THIS[KICKS_APP]
  KICKS(KICKS)
  password[(Datastore)]

  USER --"ユーザ登録(DSC ID)"--> THIS
  USER --"勤務情報登録"--> THIS
  USER --"勤務終了"--> THIS
   output --> external
```
